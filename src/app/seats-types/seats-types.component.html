<div class="seats-types-container">
  <h3>Seats Types</h3>
  <form class="form-group seat-type-create was-validated">
    <input class="form-control"
           placeholder="Name"
           name="name"
           #name="ngModel"
           required
           [(ngModel)]="newSeatsType.name"/>
    <div class="invalid-field-message"
         *ngIf="name.errors?.required">
      Name is required
    </div>
    <br>
    <input class="form-control mt-2"
           name="displayName"
           #displayName="ngModel"
           required
           placeholder="Display name"
           [(ngModel)]="newSeatsType.displayName"/>
    <div class="invalid-field-message"
         *ngIf="displayName.errors?.required">
      Display name is required
    </div>
    <br>
    <input class="form-control mt-2"
           type="number"
           name="priceMultiplier"
           #priceMultiplier="ngModel"
           min="0"
           [min]="0"
           required
           placeholder="Price multiplier"
           [(ngModel)]="newSeatsType.priceMultiplier"/>
    <div class="invalid-field-message"
         *ngIf="priceMultiplier.errors?.required">
      Price multiplier is required
    </div>
    <div class="invalid-field-message"
         *ngIf="priceMultiplier.errors?.min">
      Price should greater than 0
    </div>
    <br>
    <div class="text-center mt-2">
      <button [disabled]="name.invalid || displayName.invalid || priceMultiplier.errors"
              class="btn btn-primary"
              (click)="createSeatsType()">Create new</button>
    </div>
  </form>

  <span>Search</span>
  <app-seats-types-search-bar
    (searchEvent)="getData($event)"
    (resetPage)="resetPage()"
  >
  </app-seats-types-search-bar>

  <!--Alerts-->
  <alert
    type="danger"
    *ngIf="error"
    [dismissible]="true"
    (onClosed)="error = null"
  >
    <span>{{error}}</span>
  </alert>
  <alert
    type="danger"
    *ngIf="serverError"
    [dismissible]="true"
    (onClosed)="serverError = null"
  >
    <h5 class="alert-heading">Server Error</h5>
    <span>{{serverError}}</span>
  </alert>
  <alert
    type="success"
    *ngIf="info"
    [dismissible]="true"
    (onClosed)="info = null"
  >
    <span>{{info}}</span>
  </alert>

  <table class="table table-responsive-sm text-center mt-3">
    <thead>
      <tr>
        <th class="selectable-thead"
            (click)="sort('name')"
        >
          <span>Name</span>
          <span *ngIf="sortingOrder.name">
            {{sortingOrder.name === 1 ? '&darr;' : '&uarr;'}}
          </span>
        </th>
        <th class="selectable-thead"
            (click)="sort('displayName')"
        >
          <span>Display Name</span>
          <span *ngIf="sortingOrder.displayName">
            {{sortingOrder.displayName === 1 ? '&darr;' : '&uarr;'}}
          </span>
        </th>
        <th class="selectable-thead"
            (click)="sort('priceMultiplier')"
        >
          <span>Price Multiplier</span>
          <span *ngIf="sortingOrder.priceMultiplier">
            {{sortingOrder.priceMultiplier === 1 ? '&darr;' : '&uarr;'}}
          </span>
        </th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let seatsType of data">
        <td>
          <span *ngIf="!seatsType.isEditing">{{seatsType.name}}</span>
          <input class="form-control"
                 *ngIf="seatsType.isEditing"
                 #name="ngModel"
                 required
                 [(ngModel)]="seatsType.name">
        </td>
        <td>
          <span *ngIf="!seatsType.isEditing">{{seatsType.displayName}}</span>
          <input *ngIf="seatsType.isEditing"
                 class="form-control"
                 #displayName="ngModel"
                 required
                 [(ngModel)]="seatsType.displayName">
        </td>
        <td>
          <span *ngIf="!seatsType.isEditing">{{seatsType.priceMultiplier}}</span>
          <input type="number"
                 min="0"
                 [min]="0"
                 #price="ngModel"
                 required
                 class="form-control"
                 *ngIf="seatsType.isEditing"
                 [(ngModel)]="seatsType.priceMultiplier">
        </td>
        <td class="text-right">
          <button class="btn btn-danger m-1"
                  (click)="deleteItem(seatsType.id)">Delete</button>
          <button class="btn btn-primary m-1"
                  *ngIf="seatsType.isEditing"
                  (click)="onEdit(seatsType)">
            Save
          </button>
          <button class="btn btn-primary m-1"
                  *ngIf="!seatsType.isEditing"
                  (click)="toggleEdit(seatsType)">
            Edit
          </button>
        </td>
      </tr>
    </tbody>
  </table>
  <div class="d-flex justify-content-center">
    <pagination *ngIf="pages > 1"
                [ngModel]="page"
                [totalItems]="totalItems"
                [itemsPerPage]="itemsLimit"
                [maxSize]="8"
                [rotate]="false"
                (pageChanged)="handlePageChange($event)"
    >
    </pagination>
  </div>
</div>
